SELECT 
    ROUND(
        COUNT(CASE 
                WHEN D.order_date = D.customer_pref_delivery_date THEN 1 
             END) * 100.0 / COUNT(*),
        2
    ) AS immediate_percentage
FROM Delivery D
JOIN(
    SELECT customer_id, MIN(order_date) as first_order
    FROM Delivery
    GROUP BY customer_id
) E
ON D.customer_id = E.customer_id
AND D.order_date = E.first_order
